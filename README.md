# デュエル・マスターズ AIチャットボット

このプロジェクトは、**デュエル・マスターズのカードを検索できるAIチャットボット**です。

「〇〇ができるカードってあったっけ？」  
「コスト8以上の革命チェンジ持ちドラゴンを探したい」
等々そんな時に、カードを一枚ずつ調べなくても、**チャット感覚で条件に合うカードを探せる**ツールを開発中です。

まだ開発途中ですが、将来的には**カード検索をもっと直感的・高速にするツール**になる予定です。

---

## 2025年12月29日までの開発状況

### 完成した機能

#### 1. 検索システム
**2段階の検索プロセス**で高精度な検索を実現：

1. **条件抽出（LLM使用）**
   - クエリから検索条件を自動抽出
   - 例: 「5コストの革命チェンジ先のドラゴン」→ コスト=5, キーワード=革命チェンジ, 種族=ドラゴン

2. **フィルタリング ＆ ベクトル検索**
   - 厳密な条件で候補を絞り込み
   - ベクトル類似度でランキング
   - 条件一致カードに自動ボーナス付与

#### 3. Discord Bot統合
Discord上でカード検索ができるボットを実装：
- `/search` コマンドで検索
- ページネーション機能（5件ずつ表示）
- `/help` コマンドで使い方表示

## 技術スタック

### データ管理
- **Pandas**: カードデータの管理・フィルタリング
- **ChromaDB**: ベクトルデータベース（検索用）
- **CSV**: カードデータの永続化

### AI・検索
- **Ollama** (ローカル): LLMによる条件抽出（llama3.1:8b）
- **nomic-embed-text**: テキストのベクトル化
- **検索**: 条件フィルタ + ベクトル類似度

### Discord Bot
- **discord.py**: Discord API連携
- **app_commands**: スラッシュコマンド実装


## 検索の仕組み

### 1. クエリ解析（LLM）
```
ユーザー: 「5コストの革命チェンジ先のドラゴン」
    ↓
LLMが抽出:
{
  "cost_min": 5,
  "cost_max": 5,
  "keywords": ["革命チェンジ"],
  "race_keywords": ["ドラゴン"]
}
```

### 2. フィルタリング
```
11,244枚
  → コスト5のみ
  → 革命チェンジ持ちのみ
  → ドラゴン種族のみ
  ↓
約50枚に絞り込み
```

### 3. ベクトル検索
```
50枚の候補
  → ベクトル類似度でランキング
  → 条件一致ボーナス付与
  ↓
最終結果: 上位50件
```

## 検索例

### 例1: 基本的な検索
```
/search 5コストの革命チェンジ先のドラゴン
```
→ コスト5、革命チェンジ持ち、ドラゴン種族のカードを表示

### 例2: 俗語で検索
```
/search サイバーでメクレイドができるカード
```
→ サイバー種族でメクレイド効果を持つカードを表示


## Discordでの使用例

<img width="1314" height="1050" alt="image" src="https://github.com/user-attachments/assets/c2fde562-af63-4f1d-ae42-48055e01edc4" />


---

## 2025年12月25日までの開発状況

#### ・カードデータのスクレイピング
公式サイトからカード情報を取得し、カード名・テキストなどをデータとして保存しています。

#### ・データ保存
取得したカード情報はCSV / データベース形式で管理しています。


## スクレイピングについて

本プロジェクトでは、カード検索機能の実現を目的として、デュエル・マスターズ公式サイトからカード情報を取得しています。
https://dm.takaratomy.co.jp/card/

取得している主な情報は以下の通りです：

- カード名  
- カードテキスト  
- コスト  
- 文明  
- 種族  

※ カード画像の取得・配布は行っていません。  
※ 商用利用を目的とした使用は行っていません。


### 著作権・サイトポリシーについて

株式会社タカラトミーのサイトポリシーは以下に記載されています。

https://www.takaratomy.co.jp/utility/sitepolicy/

同サイトポリシー内の「著作権について」には、以下のように明記されています。


> 当社ウェブサイトにある文章・画像・動画・ゲーム・商標・肖像等、（以下、「ウェブデータ」）に関する著作権とその他の権利は、当社または原著作者、その他の権利者のものです。企業等が非営利目的で使用する場合、個人的な使用を目的とする場合、その他著作権法により認められている場合を除き、ウェブデータは当社、原著作者、その他の権利者の許諾なく使用することは出来ません。


本プロジェクトは **非営利・個人開発** の範囲で、カード検索の研究・学習目的としてデータを利用しています。

そのため、上記サイトポリシーの内容を踏まえたうえで本プロジェクトを紹介・公開しています。

なお、**他のトレーディングカードゲームにおいて同様の取り組みを行う場合は、各公式サイトごとに定められているサイトポリシー・利用規約を必ず確認したうえで実施してください。**


## 技術スタック

### スクレイピング
- **Selenium**: 動的なWebページからデータ取得
- **BeautifulSoup**: HTML解析
- **Requests**: HTTP通信


## スクレイピング中のスクリーンショット

以下の画像のように、スクレイピング実行中は**ターミナル上に取得中のカード情報（カード名など）が逐次表示**されます。

これにより、処理の進行状況や取得状況をリアルタイムで確認できます。

<!-- スクリーンショットをここに追加 -->
<img width="343" height="345" alt="Screenshot 2025-12-25 at 14 47 33" src="https://github.com/user-attachments/assets/cb40cf79-9dcc-4286-9d57-2e15829225f0" />

また、**すでに取得済みの同名カードが出現した場合はターミナル上に「スキップ」と表示され、重複取得を防止**しています。

<img width="333" height="328" alt="Screenshot 2025-12-25 at 14 52 29" src="https://github.com/user-attachments/assets/db106029-9a95-4a59-ac2d-c3747d373154" />



---

## 注意事項

- 本プロジェクトは**非公式・個人開発**です
- デュエル・マスターズは株式会社タカラトミーの著作物です
- 商用利用は想定していません
